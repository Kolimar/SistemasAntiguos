<div class="page-wrapper">

    <!-- HEADER -->

    <page-header>
    </page-header>

    <!-- FINAL DE HEADER -->

    <!-- DIVISOR -->

    <div class="clearfix"> </div>

    <!-- FINAL DE DIVISOR -->



    <div class="page-container">

        <!-- SIDEBAR -->

        <page-sidebar>
        </page-sidebar>

        <!-- FINAL SIDEBAR -->

        <!-- CONTENIDO -->

        <div class="page-content-wrapper">

            <div class="page-content">

                <div class="row">
                    <div class="col-md-12">
                        <!-- Begin: Demo Datatable 1 -->
                        <div class="portlet light portlet-fit portlet-datatable bordered">
                            <div class="portlet-title">
                                <div class="caption">
                                    <ol class="breadcrumb" style="background-color:transparent;">
                                        <li class="caption-subject font-dark sbold uppercase"><i class="fa fa-thumb-tack" aria-hidden="true"></i> Tareas</li>
                                    </ol>
                                </div>
                                <div class="actions">
                                    <button class="btn btn-sm yellow btn-outline sbold" (click)="vistaSimple()">
                                        <i class="fa fa-eye-slash"></i> Vista simple
                                    </button>
                                    <button class="btn btn-sm green btn-outline sbold" (click)="vistaCompleta()">
                                        <i class="fa fa-eye"></i> Vista Completa
                                    </button>
                                    <button class="btn blue sbold" (click)="showModalCrear()"><i class="fa fa-plus"></i> Nueva tarea</button>
                                </div>
                            </div>
                            <div class="portlet-body">
                                <div class="table-container">
                                    <table class="table table-striped table-bordered table-hover table-header-fixed">
                                        <thead>
                                            <tr role="row" class="heading">
                                                <th>Fecha límite
                                                    <div class="pull-right">
                                                        <i (click)="filter(es_critica_filtro, ultimo_milestone_filtro, titulo_filtro, descripcion_filtro, fecha_limite_filtro, fecha_ejecucion_filtro, urgente_filtro, falta_info_filtro, prioridad_filtro, tipo_tarea_filtro, cliente_filtro, nombre_servicio_filtro, asignado_filtro, estado_filtro, titulo_ord='', fecha_limite_ord='', fecha_ejecucion_ord='ASC', prioridad_ord='')" class="fa fa-caret-up" style="cursor: pointer;font-size: 2rem;"></i>

                                                        <i (click)="filter(es_critica_filtro, ultimo_milestone_filtro, titulo_filtro, descripcion_filtro, fecha_limite_filtro, fecha_ejecucion_filtro, urgente_filtro, falta_info_filtro, prioridad_filtro, tipo_tarea_filtro, cliente_filtro, nombre_servicio_filtro, asignado_filtro, estado_filtro, titulo_ord='', fecha_limite_ord='', fecha_ejecucion_ord='DESC', prioridad_ord='')" class="fa fa-caret-down" style="cursor: pointer;font-size: 2rem;"></i>
                                                    </div>
                                                </th>
                                                <th *ngIf="vista == 1">
                                                Fecha de ejecución
                                                    <div class="pull-right">
                                                        <i (click)="filter(es_critica_filtro, ultimo_milestone_filtro, titulo_filtro, descripcion_filtro, fecha_limite_filtro, fecha_ejecucion_filtro, urgente_filtro, falta_info_filtro, prioridad_filtro, tipo_tarea_filtro, cliente_filtro, nombre_servicio_filtro, asignado_filtro, estado_filtro, titulo_ord='', fecha_limite_ord='ASC', fecha_ejecucion_ord='', prioridad_ord='')" class="fa fa-caret-up" style="cursor: pointer;font-size: 2rem;"></i>

                                                        <i (click)="filter(es_critica_filtro, ultimo_milestone_filtro, titulo_filtro, descripcion_filtro, fecha_limite_filtro, fecha_ejecucion_filtro, urgente_filtro, falta_info_filtro, prioridad_filtro, tipo_tarea_filtro, cliente_filtro, nombre_servicio_filtro, asignado_filtro, estado_filtro, titulo_ord='', fecha_limite_ord='DESC', fecha_ejecucion_ord='', prioridad_ord='')" class="fa fa-caret-down" style="cursor: pointer;font-size: 2rem;"></i>
                                                    </div>
                                                </th>
                                                <th>Título
                                                    <div class="pull-right">
                                                        <i (click)="filter(es_critica_filtro, ultimo_milestone_filtro, titulo_filtro, descripcion_filtro, fecha_limite_filtro, fecha_ejecucion_filtro, urgente_filtro, falta_info_filtro, prioridad_filtro, tipo_tarea_filtro, cliente_filtro, nombre_servicio_filtro, asignado_filtro, estado_filtro, titulo_ord='ASC', fecha_limite_ord='', fecha_ejecucion_ord='', prioridad_ord='')" class="fa fa-caret-up" style="cursor: pointer;font-size: 2rem;"></i>

                                                        <i (click)="filter(es_critica_filtro, ultimo_milestone_filtro, titulo_filtro, descripcion_filtro, fecha_limite_filtro, fecha_ejecucion_filtro, urgente_filtro, falta_info_filtro, prioridad_filtro, tipo_tarea_filtro, cliente_filtro, nombre_servicio_filtro, asignado_filtro, estado_filtro, titulo_ord='DESC', fecha_limite_ord='', fecha_ejecucion_ord='', prioridad_ord='')" class="fa fa-caret-down" style="cursor: pointer;font-size: 2rem;"></i>
                                                    </div>
                                                </th>
                                                <th>Descripción</th>
                                                <th>Tipo de tarea</th>
                                                <th>Cliente</th>
                                                <th *ngIf="vista == 1">Servicio asociado al cliente</th>
                                                <th>Asignado a</th>
                                                <th>Prioridad
                                                    <div class="pull-right">
                                                        <i (click)="filter(es_critica_filtro, ultimo_milestone_filtro, titulo_filtro, descripcion_filtro, fecha_limite_filtro, fecha_ejecucion_filtro, urgente_filtro, falta_info_filtro, prioridad_filtro, tipo_tarea_filtro, cliente_filtro, nombre_servicio_filtro, asignado_filtro, estado_filtro, titulo_ord='ASC', fecha_limite_ord='', fecha_ejecucion_ord='', prioridad_ord='ASC')" class="fa fa-caret-up" style="cursor: pointer;font-size: 2rem;"></i>

                                                        <i (click)="filter(es_critica_filtro, ultimo_milestone_filtro, titulo_filtro, descripcion_filtro, fecha_limite_filtro, fecha_ejecucion_filtro, urgente_filtro, falta_info_filtro, prioridad_filtro, tipo_tarea_filtro, cliente_filtro, nombre_servicio_filtro, asignado_filtro, estado_filtro, titulo_ord='DESC', fecha_limite_ord='', fecha_ejecucion_ord='', prioridad_ord='DESC')" class="fa fa-caret-down" style="cursor: pointer;font-size: 2rem;"></i>
                                                    </div>
                                                </th>
                                                <th *ngIf="vista == 1">Es urgente?</th>
                                                <th>Falta info?</th>
                                                <th *ngIf="vista == 1">¿Es crítica?</th>
                                                <th *ngIf="vista == 1">Último milestone</th>
                                                <th>Estado</th>
                                                <th>Acciones</th>
                                            </tr>
                                            <tr role="row" class="filter">
                                                <th>
                                                    <input class="form-control form-filter input-sm" type="text" [(ngModel)]="fecha_limite_filtro" #ctrl="ngModel" (change)="filter(es_critica_filtro, ultimo_milestone_filtro, titulo_filtro, descripcion_filtro, fecha_limite_filtro, fecha_ejecucion_filtro, urgente_filtro, falta_info_filtro, prioridad_filtro, tipo_tarea_filtro, cliente_filtro, nombre_servicio_filtro, asignado_filtro, estado_filtro, titulo_ord, fecha_limite_ord, fecha_ejecucion_ord, prioridad_ord)" id="fechaLimiteFilter">
                                                </th>
                                                <th *ngIf="vista == 1">
                                                    <input class="form-control form-filter input-sm" type="text" [(ngModel)]="fecha_ejecucion_filtro" #ctrl="ngModel" (change)="filter(es_critica_filtro, ultimo_milestone_filtro, titulo_filtro, descripcion_filtro, fecha_limite_filtro, fecha_ejecucion_filtro, urgente_filtro, falta_info_filtro, prioridad_filtro, tipo_tarea_filtro, cliente_filtro, nombre_servicio_filtro, asignado_filtro, estado_filtro, titulo_ord, fecha_limite_ord, fecha_ejecucion_ord, prioridad_ord)" id="fechaEjecucionFilter">
                                                </th>
                                                <th>
                                                    <input class="form-control form-filter input-sm" type="text" [(ngModel)]="titulo_filtro" #ctrl="ngModel" (change)="filter(es_critica_filtro, ultimo_milestone_filtro, titulo_filtro, descripcion_filtro, fecha_limite_filtro, fecha_ejecucion_filtro, urgente_filtro, falta_info_filtro, prioridad_filtro, tipo_tarea_filtro, cliente_filtro, nombre_servicio_filtro, asignado_filtro, estado_filtro, titulo_ord, fecha_limite_ord, fecha_ejecucion_ord, prioridad_ord)" id="tituloFilter">
                                                </th>
                                                <th>
                                                    <input class="form-control form-filter input-sm" type="text" [(ngModel)]="descripcion_filtro" #ctrl="ngModel" (change)="filter(es_critica_filtro, ultimo_milestone_filtro, titulo_filtro, descripcion_filtro, fecha_limite_filtro, fecha_ejecucion_filtro, urgente_filtro, falta_info_filtro, prioridad_filtro, tipo_tarea_filtro, cliente_filtro, nombre_servicio_filtro, asignado_filtro, estado_filtro, titulo_ord, fecha_limite_ord, fecha_ejecucion_ord, prioridad_ord)" id="descripcionFilter">
                                                </th>
                                                <th>
                                                    <select class="form-control form-filter input-sm" [(ngModel)]="tipo_tarea_filtro" #ctrl="ngModel" (change)="filter(es_critica_filtro, ultimo_milestone_filtro, titulo_filtro, descripcion_filtro, fecha_limite_filtro, fecha_ejecucion_filtro, urgente_filtro, falta_info_filtro, prioridad_filtro, tipo_tarea_filtro, cliente_filtro, nombre_servicio_filtro, asignado_filtro, estado_filtro, titulo_ord, fecha_limite_ord, fecha_ejecucion_ord, prioridad_ord)" id="prioridadFilter">
                                                        <option value="">Ninguno...</option>
                                                        <option *ngFor="let tipo_tarea of cmbTiposTareas" value="{{ tipo_tarea.id }}">{{ tipo_tarea.nombre }}</option>
                                                    </select>
                                                </th>
                                                <th>
                                                    <select class="form-control form-filter input-sm" type="text" [(ngModel)]="cliente_filtro" #ctrl="ngModel" (change)="filter(es_critica_filtro, ultimo_milestone_filtro, titulo_filtro, descripcion_filtro, fecha_limite_filtro, fecha_ejecucion_filtro, urgente_filtro, falta_info_filtro, prioridad_filtro, tipo_tarea_filtro, cliente_filtro, nombre_servicio_filtro, asignado_filtro, estado_filtro, titulo_ord, fecha_limite_ord, fecha_ejecucion_ord, prioridad_ord)" id="clienteFilter">
                                                      <option value="" selected>Ninguno...</option>
                                                      <option *ngFor="let clientes of cmbClientes" value="{{ clientes.id }}">{{ clientes.nombre }}</option>
                                                    </select>
                                                </th>
                                                <th *ngIf="vista == 1">
                                                    <input class="form-control form-filter input-sm" type="text" [(ngModel)]="nombre_servicio_filtro" #ctrl="ngModel" (change)="filter(es_critica_filtro, ultimo_milestone_filtro, titulo_filtro, descripcion_filtro, fecha_limite_filtro, fecha_ejecucion_filtro, urgente_filtro, falta_info_filtro, prioridad_filtro, tipo_tarea_filtro, cliente_filtro, nombre_servicio_filtro, asignado_filtro, estado_filtro, titulo_ord, fecha_limite_ord, fecha_ejecucion_ord, prioridad_ord)" id="servicioFilter">
                                                </th>
                                                <th>
                                                    <select class="form-control form-filter input-sm" type="text" [(ngModel)]="asignado_filtro" #ctrl="ngModel" (change)="filter(es_critica_filtro, ultimo_milestone_filtro, titulo_filtro, descripcion_filtro, fecha_limite_filtro, fecha_ejecucion_filtro, urgente_filtro, falta_info_filtro, prioridad_filtro, tipo_tarea_filtro, cliente_filtro, nombre_servicio_filtro, asignado_filtro, estado_filtro, titulo_ord, fecha_limite_ord, fecha_ejecucion_ord, prioridad_ord)" id="asignadoFilter">
                                                        <option value="-1">Ninguno...</option>
                                                        <option *ngFor="let users of cmbUsers" value="{{ users.id }}">{{ users.nombres }} {{ users.apellidos }}</option>
                                                    </select>
                                                </th>
                                                <th>
                                                    <select class="form-control form-filter input-sm" [(ngModel)]="prioridad_filtro" #ctrl="ngModel" (change)="filter(es_critica_filtro, ultimo_milestone_filtro, titulo_filtro, descripcion_filtro, fecha_limite_filtro, fecha_ejecucion_filtro, urgente_filtro, falta_info_filtro, prioridad_filtro, tipo_tarea_filtro, cliente_filtro, nombre_servicio_filtro, asignado_filtro, estado_filtro, titulo_ord, fecha_limite_ord, fecha_ejecucion_ord, prioridad_ord)" id="prioridadFilter">
                                                        <option value="">Ninguno...</option>
                                                        <option value="Alta">Alta</option>
                                                        <option value="Media">Media</option>
                                                        <option value="Baja">Baja</option>
                                                    </select>
                                                </th>
                                                <th *ngIf="vista == 1">
                                                    <select class="form-control form-filter input-sm" [(ngModel)]="urgente_filtro" #ctrl="ngModel" (change)="filter(es_critica_filtro, ultimo_milestone_filtro, titulo_filtro, descripcion_filtro, fecha_limite_filtro, fecha_ejecucion_filtro, urgente_filtro, falta_info_filtro, prioridad_filtro, tipo_tarea_filtro, cliente_filtro, nombre_servicio_filtro, asignado_filtro, estado_filtro, titulo_ord, fecha_limite_ord, fecha_ejecucion_ord, prioridad_ord)" id="urgenteFilter">
                                                        <option value="">Ninguno...</option>
                                                        <option value="1">Si</option>
                                                        <option value="0">No</option>
                                                    </select>
                                                </th>
                                                <th>
                                                    <select class="form-control form-filter input-sm" [(ngModel)]="falta_info_filtro" #ctrl="ngModel" (change)="filter(es_critica_filtro, ultimo_milestone_filtro, titulo_filtro, descripcion_filtro, fecha_limite_filtro, fecha_ejecucion_filtro, urgente_filtro, falta_info_filtro, prioridad_filtro, tipo_tarea_filtro, cliente_filtro, nombre_servicio_filtro, asignado_filtro, estado_filtro, titulo_ord, fecha_limite_ord, fecha_ejecucion_ord, prioridad_ord)" id="faltaInfoFilter">
                                                        <option value="">Ninguno...</option>
                                                        <option value="1">Si</option>
                                                        <option value="0">No</option>
                                                    </select>
                                                </th>
                                                <th *ngIf="vista == 1">
                                                    <select class="form-control form-filter input-sm" [(ngModel)]="es_critica_filtro" #ctrl="ngModel" (change)="filter(es_critica_filtro, ultimo_milestone_filtro, titulo_filtro, descripcion_filtro, fecha_limite_filtro, fecha_ejecucion_filtro, urgente_filtro, falta_info_filtro, prioridad_filtro, tipo_tarea_filtro, cliente_filtro, nombre_servicio_filtro, asignado_filtro, estado_filtro, titulo_ord, fecha_limite_ord, fecha_ejecucion_ord, prioridad_ord)" id="esCriticaFilter">
                                                        <option value="">Ninguna...</option>
                                                        <option value="1">Si</option>
                                                        <option value="0">No</option>
                                                    </select>
                                                </th>
                                                <th *ngIf="vista == 1">
                                                    <select class="form-control form-filter input-sm" [(ngModel)]="ultimo_milestone_filtro" #ctrl="ngModel" (change)="filter(es_critica_filtro, ultimo_milestone_filtro, titulo_filtro, descripcion_filtro, fecha_limite_filtro, fecha_ejecucion_filtro, urgente_filtro, falta_info_filtro, prioridad_filtro, tipo_tarea_filtro, cliente_filtro, nombre_servicio_filtro, asignado_filtro, estado_filtro, titulo_ord, fecha_limite_ord, fecha_ejecucion_ord, prioridad_ord)" id="ultimoMilestoneFilter">
                                                        <option value="">Ninguno...</option>
                                                        <option value="1">Si</option>
                                                        <option value="0">No</option>
                                                    </select>
                                                </th>
                                                <th>
                                                    <select class="form-control form-filter input-sm" [(ngModel)]="estado_filtro" #ctrl="ngModel" (change)="filter(es_critica_filtro, ultimo_milestone_filtro, titulo_filtro, descripcion_filtro, fecha_limite_filtro, fecha_ejecucion_filtro, urgente_filtro, falta_info_filtro, prioridad_filtro, tipo_tarea_filtro, cliente_filtro, nombre_servicio_filtro, asignado_filtro, estado_filtro, titulo_ord, fecha_limite_ord, fecha_ejecucion_ord, prioridad_ord)" id="estadoFilter">
                                                        <option value="-1">Ninguno...</option>
                                                        <option value="Borrador">Borrador</option>
                                                        <option value="Pendiente">Pendiente</option>
                                                        <option value="Completada">Completada</option>
                                                        <option value="Eliminada">Eliminada</option>
                                                    </select>
                                                </th>
                                                <th>
                                                    <div class="margin-bottom-5">
                                                        <div class="margin-bottom-5">
                                                            <button (click)="cleanFilter()" class="btn dark btn-outline btn-sm" (click)="filter(es_critica_filtro='', ultimo_milestone_filtro='', titulo_filtro='', descripcion_filtro='', fecha_limite_filtro='', fecha_ejecucion_filtro='', urgente_filtro='', falta_info_filtro='', prioridad_filtro='', tipo_tarea_filtro='', cliente_filtro='', nombre_servicio_filtro='', asignado_filtro=currentUser, estado_filtro='Pendiente', titulo_ord='', fecha_limite_ord='', fecha_ejecucion_ord='', prioridad_ord='')">
                                                                <i class="fa fa-times"></i> Limpiar
                                                            </button>
                                                        </div>
                                                    </div>
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr *ngFor="let tareas of listTareas; let i=index">
                                                <td>{{ tareas.fecha_limite }}</td>
                                                <td *ngIf="vista == 1">{{ tareas.fecha_ejecucion }}</td>
                                                <td>{{ tareas.titulo }} <span *ngIf="tareas.nombre_servicio" class="label label-sm label-success"><strong>{{ tareas.nombre_servicio }}</strong></span></td>
                                                <td>{{ tareas.descripcionConvertidaHTML }}</td>
                                                <td>{{ tareas.nombre_tipo_tarea }}</td>
                                                <td>{{ tareas.nombre_cliente }}</td>
                                                <td *ngIf="vista == 1">{{ tareas.nombre_servicio }}</td>
                                                <td>{{ tareas.nombres_asignado }} {{ tareas.apellidos_asignado }}</td>
                                                <td>{{ tareas.prioridad }}</td>

                                                <td *ngIf="tareas.urgente == 0 && vista == 1">No</td>
                                                <td *ngIf="tareas.urgente == 1 && vista == 1">Si</td>
                                                <td *ngIf="tareas.urgente == NULL && vista == 1"></td>

                                                <td *ngIf="tareas.falta_info == 0">No</td>
                                                <td *ngIf="tareas.falta_info == 1">Si</td>
                                                <td *ngIf="tareas.falta_info == NULL"></td>

                                                <td *ngIf="tareas.es_critica == 0 && vista == 1">No</td>
                                                <td *ngIf="tareas.es_critica == 1 && vista == 1">Si</td>
                                                <td *ngIf="tareas.es_critica == NULL && vista == 1"></td>

                                                <td *ngIf="tareas.ultimo_milestone == 0 && vista == 1">No</td>
                                                <td *ngIf="tareas.ultimo_milestone == 1 && vista == 1">Si</td>
                                                <td *ngIf="tareas.ultimo_milestone == NULL && vista == 1"></td>

                                                <td *ngIf="tareas.estado == 'Borrador'"><span class="label label-sm label-default"><strong>{{ tareas.estado }}</strong></span></td>
                                                <td *ngIf="tareas.estado == 'Pendiente'"><span class="label label-sm label-warning"><strong>{{ tareas.estado }}</strong></span></td>
                                                <td *ngIf="tareas.estado == 'Completada'"><span class="label label-sm label-success"><strong>{{ tareas.estado }}</strong></span></td>
                                                <td *ngIf="tareas.estado == 'Eliminada'"><span class="label label-sm label-danger"><strong>{{ tareas.estado }}</strong></span></td>

                                                <td>
                                                    <div class="btn-group">
                                                        <button class="btn btn-sm yellow sbold dropdown-toggle" type="button" data-toggle="dropdown">Acciones
                                                            <i class="fa fa-angle-down"></i>
                                                        </button>
                                                        <ul class="dropdown-menu" role="menu">
                                                            <li>
                                                                <a (click)="showModalEditar(tareas, i)"><i class="fa fa-pencil"></i> Editar</a>
                                                            </li>
                                                            <li>
                                                                <a data-toggle="modal" data-target="#eliminar-tarea" (click)="onDelete(tareas, i)"><i class="fa fa-trash"></i> Eliminar</a>
                                                            </li>
                                                            <li>
                                                                <a (click)="showModalSubtareas(tareas.id)"><i class="fa fa-check-circle"></i> Subtareas</a>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </td>

                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="row">
                                    <button type="button" class="btn green" style="width: 100%" (click)="search(es_critica_filtro, ultimo_milestone_filtro, titulo_filtro, descripcion_filtro, fecha_limite_filtro, fecha_ejecucion_filtro, urgente_filtro, falta_info_filtro, prioridad_filtro, tipo_tarea_filtro, cliente_filtro, nombre_servicio_filtro, asignado_filtro, estado_filtro, titulo_ord, fecha_limite_ord, fecha_ejecucion_ord, prioridad_ord)">
                                        <strong>
                                            Ver más <i class="fa fa-caret-down" aria-hidden="true"></i>
                                        </strong>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

        </div>

        <!-- FINAL DEL CONTENIDO -->

    </div>

    <!-- FOOTER -->

    <page-footer>
    </page-footer>

    <!-- FINAL DE FOOTER -->

</div>

<div class="quick-nav-overlay"></div>

<!-- MODAL NUEVA TAREA  -->

<div bsModal #modalCrear="bs-modal" id="nueva-tarea" class="modal fade" tabindex="-1" role="basic" aria-hidden="true" [config]="{backdrop: 'static', keyboard: false}">
    <div class="modal-dialog modal-lg">

        <div class="modal-content">

            <form class="form-horizontal" novalidate [formGroup]="formCreacion" id="fmrCreateTareas">

                <div class="modal-header">

                    <h4 class="modal-title pull-left">Nueva Tarea</h4>

                    <div class="pull-right">
                      <button type="button" class="btn dark btn-outline" (click)="hideModalCrear()">Cerrar</button>
                      <button class="btn yellow sbold" [disabled]="loader" (click)="borrador()">
                          Guardar en borrador
                          <img *ngIf="loader" src="assets/img/loader.gif" class="gif-loader">
                      </button>
                      <button class="btn blue sbold" [disabled]="loader" (click)="create()">
                          Crear tarea
                          <img *ngIf="loader" src="assets/img/loader.gif" class="gif-loader">
                      </button>
                    </div>

                </div>

                <div class="modal-body">

                    <div class="caption">
                        <span class="caption-subject bold"> General</span>
                        <br>
                        <br>
                    </div>

                    <div class="form-group">
                        <label for="id_tarea_template" class="control-label col-md-3">
                            Tarea template
                        </label>
                        <div class="col-md-8">
                            <select (change)="onSelectTareaTemplate(formCreacion.value.id_tarea_template)" name="id_tarea_template" id="id_tarea_template" formControlName="id_tarea_template" class="form-control">
                                <option value="">Ninguna...</option>
                                <option *ngFor="let tareas_templates of cmbTareasTemplates" value="{{ tareas_templates.id }}">{{ tareas_templates.titulo }}</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group" [ngClass]="{ 'has-error': formCreacion.controls.titulo.errors && formCreacion.controls.titulo.pristine && isSubmitTarea }">
                        <label for="titulo" class="control-label col-md-3">
                            Título <strong class="text-danger">*</strong>
                        </label>
                        <div class="col-md-8">
                            <input type="text" name="titulo" id="titulo" formControlName="titulo" class="form-control">
                        </div>
                        <div class="col-md-offset-3 col-md-8" *ngIf="formCreacion.controls.titulo.errors && formCreacion.controls.titulo.pristine && isSubmitTarea">
                            <strong class="help-block" *ngIf="formCreacion.controls.titulo.errors.required && formCreacion.controls.titulo.pristine && isSubmitTarea">El título es requerido</strong>
                            <strong class="help-block" *ngIf="formCreacion.controls.titulo.errors.maxlength && formCreacion.controls.titulo.pristine && isSubmitTarea">El título no debe tener mas de 50 caracteres</strong>
                            <strong class="help-block" *ngIf="formCreacion.controls.titulo.errors.sinEspacios && formCreacion.controls.titulo.pristine && isSubmitTarea">El título no debe poseer espacios en blanco al inicio del texto</strong>
                        </div>
                    </div>

                    <div class="form-group" [ngClass]="{ 'has-error': formCreacion.controls.descripcion.errors && formCreacion.controls.descripcion.pristine && isSubmitTarea && status == 1 }">
                        <label for="descripcion" class="control-label col-md-3">
                            Descripción
                        </label>
                        <div class="col-md-8">
                            <textarea class="form-control" name="descripcion" id="descripcion" formControlName="descripcion" rows="8"></textarea>
                        </div>
                        <div class="col-md-offset-3 col-md-8" *ngIf="formCreacion.controls.descripcion.errors && formCreacion.controls.descripcion.pristine && isSubmitTarea && status == 1">
                            <strong class="help-block" *ngIf="formCreacion.controls.descripcion.errors.sinEspacios && formCreacion.controls.descripcion.pristine && isSubmitTarea && status == 1">La descripción no debe poseer espacios en blanco al inicio del texto</strong>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="id_cliente" class="control-label col-md-3">
                            Cliente
                        </label>
                        <div class="col-md-8">
                            <select name="id_cliente" id="id_cliente" formControlName="id_cliente" class="form-control" (change)="onSelectCliente(formCreacion.value.id_cliente)">
                                <option value="" selected>Ninguno...</option>
                                <option *ngFor="let clientes of cmbClientesActivos" value="{{ clientes.id }}">{{ clientes.nombre }}</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="id_servicio" class="control-label col-md-3">
                            Servicio asociado al cliente
                        </label>
                        <div class="col-md-8">
                            <select name="id_servicio" id="id_servicio" formControlName="id_servicio" class="form-control">
                                <option value="" selected>Ninguno...</option>
                                <option *ngFor="let servicios of cmbClientesServicios" value="{{ servicios.id_servicio }}">{{ servicios.nombre_servicio }}</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group" [ngClass]="{ 'has-error': formCreacion.controls.id_tipo_tarea.errors && formCreacion.controls.id_tipo_tarea.pristine && isSubmitTarea && status == 1 }">
                        <label for="id_tipo_tarea" class="control-label col-md-3">
                            Tipo de tarea <strong class="text-danger">*</strong>
                        </label>
                        <div class="col-md-8">
                            <select name="id_tipo_tarea" id="id_tipo_tarea" formControlName="id_tipo_tarea" class="form-control">
                                <option *ngFor="let tipo_tarea of cmbTiposTareas" value="{{ tipo_tarea.id }}">{{ tipo_tarea.nombre }}</option>
                            </select>
                        </div>
                        <div class="col-md-offset-3 col-md-8" *ngIf="formCreacion.controls.id_tipo_tarea.errors && formCreacion.controls.id_tipo_tarea.pristine && isSubmitTarea && status == 1">
                            <strong class="help-block" *ngIf="formCreacion.controls.id_tipo_tarea.errors.required && formCreacion.controls.id_tipo_tarea.pristine && isSubmitTarea && status == 1">Debe asignar un tipo de tarea</strong>
                        </div>
                    </div>

                    <div class="caption">
                        <hr>
                        <span class="caption-subject bold"> Asignación y fechas</span>
                        <br>
                        <br>
                    </div>

                    <div class="form-group" [ngClass]="{ 'has-error': formCreacion.controls.id_asignado.errors && formCreacion.controls.id_asignado.pristine && isSubmitTarea && status == 1 }">
                        <label for="id_asignado" class="control-label col-md-3">
                            Asignar a <strong class="text-danger">*</strong>
                        </label>
                        <div class="col-md-8">
                            <select name="id_asignado" id="id_asignado" formControlName="id_asignado" class="form-control">
                                <option value="" selected>Ninguno...</option>
                                <option *ngFor="let users of cmbUsers" value="{{ users.id }}">{{ users.nombres }} {{ users.apellidos }}</option>
                            </select>
                        </div>
                        <div class="col-md-offset-3 col-md-8" *ngIf="formCreacion.controls.id_asignado.errors && formCreacion.controls.id_asignado.pristine && isSubmitTarea && status == 1">
                            <strong class="help-block" *ngIf="formCreacion.controls.id_asignado.errors.required && formCreacion.controls.id_asignado.pristine && isSubmitTarea && status == 1">Debe asignar a un usuario</strong>
                        </div>
                    </div>

                    <div class="form-group" [ngClass]="{ 'has-error': formCreacion.controls.fecha_limite.errors && formCreacion.controls.fecha_limite.pristine && isSubmitTarea && status == 1 }">
                        <label for="fecha_limite" class="control-label col-md-3">
                            Fecha límite <strong class="text-danger">*</strong>
                        </label>
                        <div class="col-md-8">
                            <my-date-picker name="fecha_limite" [options]="myDatePickerOptions" formControlName="fecha_limite"></my-date-picker>
                        </div>
                        <div class="col-md-offset-3 col-md-8" *ngIf="formCreacion.controls.fecha_limite.errors && formCreacion.controls.fecha_limite.pristine && isSubmitTarea && status == 1">
                            <strong class="help-block" *ngIf="formCreacion.controls.fecha_limite.errors.required && formCreacion.controls.fecha_limite.pristine && isSubmitTarea && status == 1">La fecha límite es requerida</strong>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="fecha_ejecucion" class="control-label col-md-3">
                            Fecha de ejecución
                        </label>
                        <div class="col-md-8">
                            <my-date-picker name="fecha_ejecucion" [options]="myDatePickerOptions" formControlName="fecha_ejecucion"></my-date-picker>
                        </div>
                    </div>

                    <div class="caption">
                        <hr>
                        <span class="caption-subject bold"> Opciones avanzadas</span>
                        <br>
                        <br>
                    </div>

                    <div class="form-group" [ngClass]="{ 'has-error': formCreacion.controls.urgente.errors && formCreacion.controls.urgente.pristine && isSubmitTarea && status == 1 }">
                        <label for="urgente" class="control-label col-md-3">
                            ¿Es urgente? <strong class="text-danger">*</strong>
                        </label>
                        <div class="col-md-8">
                            <select name="urgente" id="urgente" formControlName="urgente" class="form-control">
                                <option value="0" selected>No</option>
                                <option value="1">Si</option>
                            </select>
                        </div>
                        <div class="col-md-offset-3 col-md-8" *ngIf="formCreacion.controls.urgente.errors && formCreacion.controls.urgente.pristine && isSubmitTarea && status == 1">
                            <strong class="help-block" *ngIf="formCreacion.controls.urgente.errors.required && formCreacion.controls.urgente.pristine && isSubmitTarea && status == 1">La urgencia es requerida</strong>
                        </div>
                    </div>

                    <div class="form-group" [ngClass]="{ 'has-error': formCreacion.controls.falta_info.errors && formCreacion.controls.falta_info.pristine && isSubmitTarea && status == 1 }">
                        <label for="falta_info" class="control-label col-md-3">
                            ¿Falta info? <strong class="text-danger">*</strong>
                        </label>
                        <div class="col-md-8">
                            <select name="falta_info" id="falta_info" formControlName="falta_info" class="form-control">
                                <option value="0" selected>No</option>
                                <option value="1">Si</option>
                            </select>
                        </div>
                        <div class="col-md-offset-3 col-md-8" *ngIf="formCreacion.controls.falta_info.errors && formCreacion.controls.falta_info.pristine && isSubmitTarea && status == 1">
                            <strong class="help-block" *ngIf="formCreacion.controls.falta_info.errors.required && formCreacion.controls.falta_info.pristine && isSubmitTarea && status == 1">Falta info es requerida</strong>
                        </div>
                    </div>

                    <div class="form-group" [ngClass]="{ 'has-error': formCreacion.controls.prioridad.errors && formCreacion.controls.prioridad.pristine && isSubmitTarea && status == 1 }">
                        <label for="prioridad" class="control-label col-md-3">
                            Prioridad <strong class="text-danger">*</strong>
                        </label>
                        <div class="col-md-8">
                            <select name="prioridad" id="prioridad" formControlName="prioridad" class="form-control">
                                <option value="" selected>Ninguna...</option>
                                <option value="Alta" selected>Alta</option>
                                <option value="Media" selected>Media</option>
                                <option value="Baja">Baja</option>
                            </select>
                        </div>
                        <div class="col-md-offset-3 col-md-8" *ngIf="formCreacion.controls.prioridad.errors && formCreacion.controls.prioridad.pristine && isSubmitTarea && status == 1">
                            <strong class="help-block" *ngIf="formCreacion.controls.prioridad.errors.required && formCreacion.controls.prioridad.pristine && isSubmitTarea && status == 1">La prioridad es requerida</strong>
                        </div>
                    </div>

                </div>

                <div class="modal-footer">
                    <button type="button" class="btn dark btn-outline" (click)="hideModalCrear()">Cerrar</button>
                    <button class="btn yellow sbold" [disabled]="loader" (click)="borrador()">
                        Guardar en borrador
                        <img *ngIf="loader" src="assets/img/loader.gif" class="gif-loader">
                    </button>
                    <button class="btn blue sbold" [disabled]="loader" (click)="create()">
                        Crear tarea
                        <img *ngIf="loader" src="assets/img/loader.gif" class="gif-loader">
                    </button>
                </div>

            </form>

        </div>

    </div>
    <!-- /.modal-dialog -->
</div>

<!-- MODAL EDITAR TAREA  -->

<div bsModal #modalEditar="bs-modal" id="editar-tarea" class="modal fade" tabindex="-1" role="basic" aria-hidden="true" [config]="{backdrop: 'static', keyboard: false}">
    <div class="modal-dialog modal-lg">

        <div class="modal-content">

            <form *ngIf="formEdicion" class="form-horizontal" novalidate [formGroup]="formEdicion" id="fmrEditTareas">

                <div class="modal-header">

                    <h4 class="modal-title pull-left">Editar Tarea</h4>

                    <div class="pull-right">
                      <button type="button" class="btn dark btn-outline" data-dismiss="modal" (click)="hideModalEditar()">Cerrar</button>
                      <button *ngIf="editTarea.estado=='Borrador'" class="btn yellow sbold" [disabled]="loader" (click)="borradorEdit()">
                          Guardar en borrador
                          <img *ngIf="loader" src="assets/img/loader.gif" class="gif-loader">
                      </button>
                      <button *ngIf="editTarea.estado=='Borrador'" class="btn blue sbold" [disabled]="loader" (click)="createEdit()">
                          Crear tarea
                          <img *ngIf="loader" src="assets/img/loader.gif" class="gif-loader">
                      </button>
                      <button *ngIf="editTarea.estado!='Borrador'" class="btn blue sbold" [disabled]="loader" (click)="edit()">
                          Editar tarea
                          <img *ngIf="loader" src="assets/img/loader.gif" class="gif-loader">
                      </button>
                    </div>

                </div>

                <div class="modal-body">

                    <h3 *ngIf="workflowName == 'Workflow General'">{{ workflowName }} <span *ngIf="editTarea.titulo_tarea_template">/ {{ editTarea.titulo_tarea_template }}</span></h3>
                    <h3 *ngIf="workflowName == 'Workflow Ingreso de Cliente'">{{ workflowName }} / {{ editTarea.titulo }}</h3>
                    <h3 *ngIf="nombreServicioWorkflow">{{ nombreServicioWorkflow }} / {{ editTarea.titulo }}</h3>
                    <hr>

                    <div class="caption">
                        <span class="caption-subject bold"> General</span>
                        <br>
                        <br>
                    </div>

                    <div class="form-group" [ngClass]="{ 'has-error': formEdicion.controls.titulo2.errors && formEdicion.controls.titulo2.pristine && (isSubmitTarea || verValidacion) }">
                        <label for="titulo" class="control-label col-md-3">
                            Título <strong class="text-danger">*</strong>
                        </label>
                        <div class="col-md-8">
                            <input type="text" name="titulo2" id="titulo2" formControlName="titulo2" class="form-control" (change)="verificarCambio()">
                        </div>
                        <div class="col-md-offset-3 col-md-8" *ngIf="formEdicion.controls.titulo2.errors && formEdicion.controls.titulo2.pristine && (isSubmitTarea || verValidacion)">
                            <strong class="help-block" *ngIf="formEdicion.controls.titulo2.errors.required && formEdicion.controls.titulo2.pristine && (isSubmitTarea || verValidacion)">El título es requerido</strong>
                            <strong class="help-block" *ngIf="formEdicion.controls.titulo2.errors.maxlength && formEdicion.controls.titulo2.pristine && (isSubmitTarea || verValidacion)">El título no debe tener mas de 50 caracteres</strong>
                            <strong class="help-block" *ngIf="formEdicion.controls.titulo2.errors.sinEspacios && formEdicion.controls.titulo2.pristine && (isSubmitTarea || verValidacion)">El título no debe poseer espacios en blanco al inicio del texto</strong>
                        </div>
                    </div>

                    <div class="form-group" [ngClass]="{ 'has-error': formEdicion.controls.descripcion2.errors && formEdicion.controls.descripcion2.pristine && isSubmitTarea && status == 1 }">
                        <label for="descripcion2" class="control-label col-md-3">
                            Descripción
                        </label>
                        <div class="col-md-8">
                            <textarea class="form-control" name="descripcion2" id="descripcion2" formControlName="descripcion2" rows="8" (change)="verificarCambio()"></textarea>
                        </div>
                        <div class="col-md-offset-3 col-md-8" *ngIf="formEdicion.controls.descripcion2.errors && formEdicion.controls.descripcion2.pristine && isSubmitTarea && status == 1">
                            <strong class="help-block" *ngIf="formEdicion.controls.descripcion2.errors.sinEspacios && formEdicion.controls.descripcion2.pristine && isSubmitTarea && status == 1">La descripción no debe poseer espacios en blanco al inicio del texto</strong>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="id_cliente2" class="control-label col-md-3">
                            Cliente
                        </label>
                        <div class="col-md-8">
                            <select name="id_cliente2" id="id_cliente2" formControlName="id_cliente2" class="form-control" (change)="onSelectClienteEdit(formEdicion.value.id_cliente2)" (change)="verificarCambio()">
                                <option value="" selected>Ninguno...</option>
                                <option *ngFor="let clientes of cmbClientesActivos" value="{{ clientes.id }}">{{ clientes.nombre }}</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="id_servicio2" class="control-label col-md-3">
                            Servicio asociado al cliente
                        </label>
                        <div class="col-md-8">
                            <select name="id_servicio2" id="id_servicio2" formControlName="id_servicio2" class="form-control" (change)="verificarCambio()">
                                <option value="" selected>Ninguno...</option>
                                <option *ngFor="let servicios of cmbClientesServicios" value="{{ servicios.id_servicio }}">{{ servicios.nombre_servicio }}</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group" [ngClass]="{ 'has-error': formEdicion.controls.id_tipo_tarea2.errors && formEdicion.controls.id_tipo_tarea2.pristine && isSubmitTarea && status == 1 }">
                        <label for="id_tipo_tarea2" class="control-label col-md-3">
                            Tipo de tarea <strong class="text-danger">*</strong>
                        </label>
                        <div class="col-md-8">
                            <select name="id_tipo_tarea2" id="id_tipo_tarea2" formControlName="id_tipo_tarea2" class="form-control">
                                <option *ngFor="let tipo_tarea of cmbTiposTareas" value="{{ tipo_tarea.id }}">{{ tipo_tarea.nombre }}</option>
                            </select>
                        </div>
                        <div class="col-md-offset-3 col-md-8" *ngIf="formEdicion.controls.id_tipo_tarea2.errors && formEdicion.controls.id_tipo_tarea2.pristine && isSubmitTarea && status == 1">
                            <strong class="help-block" *ngIf="formEdicion.controls.id_tipo_tarea2.errors.required && formEdicion.controls.id_tipo_tarea2.pristine && isSubmitTarea && status == 1">Debe asignar un tipo de tarea</strong>
                        </div>
                    </div>

                    <div *ngIf="editTarea.estado!='Borrador'" class="form-group">
                        <label for="estado2" class="control-label col-md-3">
                            Estado
                        </label>
                        <div class="col-md-8">
                            <select name="estado2" id="estado2" formControlName="estado2" class="form-control" (change)="verificarCambio()">
                                <option value="Borrador">Borrador</option>
                                <option value="Pendiente">Pendiente</option>
                                <option value="Completada">Completada</option>
                                <option value="Eliminada">Eliminada</option>
                            </select>
                        </div>
                    </div>

                    <div class="caption">
                        <hr>
                        <span class="caption-subject bold"> Asignación y fechas</span>
                        <br>
                        <br>
                    </div>

                    <div class="form-group" [ngClass]="{ 'has-error': formEdicion.controls.id_asignado2.errors && formEdicion.controls.id_asignado2.pristine && (isSubmitTarea || verValidacion) && status == 1 }">
                        <label for="id_asignado2" class="control-label col-md-3">
                            Asignado a  <strong class="text-danger">*</strong>
                        </label>
                        <div class="col-md-8">
                            <select name="id_asignado2" id="id_asignado2" formControlName="id_asignado2" class="form-control" (change)="verificarCambio()">
                                <option value="" [selected]="id_cliente2">Ninguno...</option>
                                <option *ngFor="let users of cmbUsers" value="{{ users.id }}">{{ users.nombres }} {{ users.apellidos }}</option>
                            </select>
                        </div>
                        <div class="col-md-offset-3 col-md-8" *ngIf="formEdicion.controls.id_asignado2.errors && formEdicion.controls.id_asignado2.pristine && (isSubmitTarea || verValidacion) && status == 1">
                            <strong class="help-block" *ngIf="formEdicion.controls.id_asignado2.errors.required && formEdicion.controls.id_asignado2.pristine && (isSubmitTarea || verValidacion) && status == 1">Debe asignar a un usuario</strong>
                        </div>
                    </div>

                    <div class="form-group" [ngClass]="{ 'has-error': formEdicion.controls.fecha_limite2.errors && formEdicion.controls.fecha_limite2.pristine && (formEdicion.submitted || verValidacion) && status == 1 }">
                        <label for="fecha_limite2" class="control-label col-md-3">
                            Fecha límite <strong class="text-danger">*</strong>
                        </label>
                        <div class="col-md-8">
                            <my-date-picker name="fecha_limite2" [options]="myDatePickerOptions" formControlName="fecha_limite2" (dateChanged)="verificarCambio()"></my-date-picker>
                        </div>
                        <div class="col-md-offset-3 col-md-8" *ngIf="formEdicion.controls.fecha_limite2.errors && formEdicion.controls.fecha_limite2.pristine && (formEdicion.submitted || verValidacion) && status == 1">
                            <strong class="help-block" *ngIf="formEdicion.controls.fecha_limite2.errors.required && formEdicion.controls.fecha_limite2.pristine && (formEdicion.submitted || verValidacion) && status == 1">La fecha límite es requerida</strong>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="fecha_ejecucion2" class="control-label col-md-3">
                            Fecha de ejecución
                        </label>
                        <div class="col-md-8">
                            <my-date-picker name="fecha_ejecucion2" [options]="myDatePickerOptions" formControlName="fecha_ejecucion2" (dateChanged)="verificarCambio()"></my-date-picker>
                        </div>
                    </div>

                    <div class="caption">
                        <hr>
                        <span class="caption-subject bold"> Opciones avanzadas</span>
                        <br>
                        <br>
                    </div>

                    <div class="form-group" [ngClass]="{ 'has-error': formEdicion.controls.urgente2.errors && formEdicion.controls.urgente2.pristine && (isSubmitTarea || verValidacion) && status == 1 }">
                        <label for="urgente2" class="control-label col-md-3">
                            ¿Es urgente? <strong class="text-danger">*</strong>
                        </label>
                        <div class="col-md-8">
                            <select name="urgente2" id="urgente2" formControlName="urgente2" class="form-control" (change)="verificarCambio()">
                                <option value="0">No</option>
                                <option value="1">Si</option>
                            </select>
                        </div>
                        <div class="col-md-offset-3 col-md-8" *ngIf="formEdicion.controls.urgente2.errors && formEdicion.controls.urgente2.pristine && (isSubmitTarea || verValidacion) && status == 1">
                            <strong class="help-block" *ngIf="formEdicion.controls.urgente2.errors.required && formEdicion.controls.urgente2.pristine && (isSubmitTarea || verValidacion) && status == 1">La urgencia es requerida</strong>
                        </div>
                    </div>

                    <div class="form-group" [ngClass]="{ 'has-error': formEdicion.controls.falta_info2.errors && formEdicion.controls.falta_info2.pristine && (isSubmitTarea || verValidacion) && status == 1 }">
                        <label for="falta_info2" class="control-label col-md-3">
                            ¿Falta info? <strong class="text-danger">*</strong>
                        </label>
                        <div class="col-md-8">
                            <select name="falta_info2" id="falta_info2" formControlName="falta_info2" class="form-control" (change)="verificarCambio()">
                                <option value="0">No</option>
                                <option value="1">Si</option>
                            </select>
                        </div>
                        <div class="col-md-offset-3 col-md-8" *ngIf="formEdicion.controls.falta_info2.errors && formEdicion.controls.falta_info2.pristine && (isSubmitTarea || verValidacion) && status == 1">
                            <strong class="help-block" *ngIf="formEdicion.controls.falta_info2.errors.required && formEdicion.controls.falta_info2.pristine && (isSubmitTarea || verValidacion) && status == 1">Falta info es requerida</strong>
                        </div>
                    </div>

                    <div class="form-group" [ngClass]="{ 'has-error': formEdicion.controls.prioridad2.errors && formEdicion.controls.prioridad2.pristine && isSubmitTarea && status == 1 }">
                        <label for="prioridad2" class="control-label col-md-3">
                            Prioridad <strong class="text-danger">*</strong>
                        </label>
                        <div class="col-md-8">
                            <select name="prioridad2" id="prioridad2" formControlName="prioridad2" class="form-control">
                                <option value="" selected>Ninguna...</option>
                                <option value="Alta" selected>Alta</option>
                                <option value="Media" selected>Media</option>
                                <option value="Baja">Baja</option>
                            </select>
                        </div>
                        <div class="col-md-offset-3 col-md-8" *ngIf="formEdicion.controls.prioridad2.errors && formEdicion.controls.prioridad2.pristine && isSubmitTarea && status == 1">
                            <strong class="help-block" *ngIf="formEdicion.controls.prioridad2.errors.required && formEdicion.controls.prioridad2.pristine && isSubmitTarea && status == 1">La prioridad es requerida</strong>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="id_depende_de2" class="control-label col-md-3">
                            Depende de  <strong class="text-danger">*</strong>
                        </label>
                        <div class="col-md-8">
                          <label *ngIf="editTarea.titulo_depende" class="control-label">
                              <span class="label label-sm label-success"><strong>{{ editTarea.titulo_depende }}</strong></span>
                          </label>
                        </div>
                    </div>

                </div>

                <div class="modal-footer">
                    <button type="button" class="btn dark btn-outline" data-dismiss="modal" (click)="hideModalEditar()">Cerrar</button>
                    <button *ngIf="editTarea.estado=='Borrador'" class="btn yellow sbold" [disabled]="loader" (click)="borradorEdit()">
                        Guardar en borrador
                        <img *ngIf="loader" src="assets/img/loader.gif" class="gif-loader">
                    </button>
                    <button *ngIf="editTarea.estado=='Borrador'" class="btn blue sbold" [disabled]="loader" (click)="createEdit()">
                        Crear tarea
                        <img *ngIf="loader" src="assets/img/loader.gif" class="gif-loader">
                    </button>
                    <button *ngIf="editTarea.estado!='Borrador'" class="btn blue sbold" [disabled]="loader" (click)="edit()">
                        Editar tarea
                        <img *ngIf="loader" src="assets/img/loader.gif" class="gif-loader">
                    </button>
                </div>

            </form>

        </div>

    </div>
</div>

<!-- MODAL INGRESAR FECHA COMIENZO DE GESTION -->
<div bsModal #modalFechaPrimeraReunion="bs-modal" id="fecha-primera-reunion" class="modal fade" tabindex="-1" role="basic" aria-hidden="true" [config]="{backdrop: 'static', keyboard: false}">
    <div class="modal-dialog modal-md">
        <div class="modal-content">

            <div class="modal-header">

                <h4 class="modal-title">Ingresar fecha de primera reunión</h4>

            </div>

            <div class="modal-body">
                <form *ngIf="formIngresoFechaPrimeraReunion" class="form-horizontal" novalidate [formGroup]="formIngresoFechaPrimeraReunion" id="fmrFechaPrimeraReunion">

                  <div class="form-group" [ngClass]="{ 'has-error': formIngresoFechaPrimeraReunion.controls.fecha_primera_reunion.errors && formIngresoFechaPrimeraReunion.controls.fecha_primera_reunion.pristine && isSubmitFechaComienzo }">
                      <label for="fecha_primera_reunion" class="control-label col-md-3">
                          Fecha primera reunión <strong class="text-danger">*</strong>
                      </label>
                      <div class="col-md-8">
                          <my-date-picker name="fecha_primera_reunion" [options]="myDatePickerOptions" formControlName="fecha_primera_reunion"></my-date-picker>
                      </div>
                      <div class="col-md-offset-3 col-md-8" *ngIf="formIngresoFechaPrimeraReunion.controls.fecha_primera_reunion.errors && formIngresoFechaPrimeraReunion.controls.fecha_primera_reunion.pristine && isSubmitFechaComienzo">
                          <strong class="help-block" *ngIf="formIngresoFechaPrimeraReunion.controls.fecha_primera_reunion.errors.required && formIngresoFechaPrimeraReunion.controls.fecha_primera_reunion.pristine">La fecha límite es requerida</strong>
                      </div>
                  </div>

                </form>
            </div>

            <div class="modal-footer">
                <form>
                    <button type="button" class="btn dark btn-outline" data-dismiss="modal" (click)="hideModalIngresoFechaPrimeraReunion()">Cerrar</button>
                    <button class="btn blue sbold" (click)="ingresarFechaPrimeraReunion()">
                        Guardar fecha primera reunión
                    </button>
                </form>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>

<!-- MODAL CONFIRMAR CAMBIOS -->
<div class="modal fade" id="confirmar-cambios" tabindex="-1" role="basic" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content" style="position:relative;left:150%;">

            <div class="modal-header">

                <h4 class="modal-title">Confirmar cambios</h4>

            </div>

            <div class="modal-body">
                <h2>¿Desea guardar los cambios que hizo en el formulario?</h2>
            </div>

            <div class="modal-footer">
                <form>
                    <button class="btn blue sbold" (click)="salirGuardar()">Sí</button>
                    <button type="button" class="btn dark btn-outline" (click)="salirSinGuardar()">No</button>
                </form>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>

<!-- MODAL ELIMINAR TAREA -->
<div class="modal fade" id="eliminar-tarea" tabindex="-1" role="basic" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">

            <div class="modal-header">

                <h4 class="modal-title">Eliminar Tarea</h4>

            </div>

            <div class="modal-body" *ngIf="deleteTareas">
                <h2>¿Desea eliminar la tarea <strong>{{ deleteTareas.titulo }}?</strong> Todos los datos relacionados a este registro serán borrados definitivamente</h2>
            </div>

            <div class="modal-footer">
                <form>
                    <button type="button" class="btn dark btn-outline" data-dismiss="modal">Cerrar</button>
                    <button class="btn btn-danger sbold" [disabled]="loader" (click)="deleteTarea()">
                        Eliminar tarea
                        <img *ngIf="loader" src="assets/img/loader.gif" class="gif-loader">
                    </button>
                </form>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>

<!-- MODAL SUBTAREAS  -->

<div class="modal fade" bsModal #modalSubtareas="bs-modal" id="subtareas" tabindex="-1" role="basic" aria-hidden="true" [config]="{backdrop: 'static', keyboard: false}">
    <div class="modal-dialog modal-lg">

        <div class="modal-content">

            <form class="form-horizontal" novalidate [formGroup]="formSubtareas" id="fmrCreateSubTareas">

                <div class="modal-header">

                    <h4 class="modal-title">Subtareas</h4>

                </div>

                <div class="modal-body">

                    <div class="form-group" [ngClass]="{ 'has-error': formSubtareas.controls.titulo.errors && formSubtareas.controls.titulo.pristine && isSubmitSubtarea }">
                        <label for="titulo" class="control-label col-md-3">
                            Título <strong class="text-danger">*</strong>
                        </label>
                        <div class="col-md-8">
                            <input type="text" name="titulo" id="titulo" formControlName="titulo" class="form-control">
                        </div>
                        <div class="col-md-offset-3 col-md-8" *ngIf="formSubtareas.controls.titulo.errors && formSubtareas.controls.titulo.pristine && isSubmitSubtarea">
                            <strong class="help-block" *ngIf="formSubtareas.controls.titulo.errors.required && formSubtareas.controls.titulo.pristine && isSubmitSubtarea">El título es requerido</strong>
                            <strong class="help-block" *ngIf="formSubtareas.controls.titulo.errors.maxlength && formSubtareas.controls.titulo.pristine && isSubmitSubtarea">El título no debe tener mas de 50 caracteres</strong>
                            <strong class="help-block" *ngIf="formSubtareas.controls.titulo.errors.sinEspacios && formSubtareas.controls.titulo.pristine && isSubmitSubtarea">El título no debe poseer espacios en blanco al inicio del texto</strong>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="descripcion" class="control-label col-md-3">
                            Descripción
                        </label>
                        <div class="col-md-8">
                            <textarea type="text" name="descripcion" id="descripcion" formControlName="descripcion" class="form-control" rows="5"></textarea>
                        </div>
                    </div>

                </div>

                <div class="form-group">
                    <div class="col-md-offset-8 col-md-4">
                        <button type="button" class="btn dark btn-outline" data-dismiss="modal" (click)="hideModalSubtareas()">Cerrar</button>
                        <button class="btn blue sbold" (click)="createSubTarea()">
                            <i class="fa fa-plus"></i>
                        </button>
                    </div>
                </div>

                <hr>

                <div class="text-center" *ngFor="let cant of cantidadSubtareas">
                    <div *ngIf="cant.cantidad_subtareas > 0">
                        <h3><strong>{{ cant.cantidad_subtareas_completadas }} / {{ cant.cantidad_subtareas }} subtareas completas</strong></h3>
                        <br>
                    </div>
                </div>

                <div class="table-responsive" style="padding-left: 10px;padding-right: 10px;">
                    <table class="table table-striped table-bordered table-hover">
                        <thead>
                            <tr>
                                <th>Título</th>
                                <th>Descripción</th>
                                <th>¿Completa?</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let subtareas of listSubTareas">
                                <td contenteditable="true" (blur)="saveToDatabase($event, 'titulo', subtareas.id)">
                                    {{ subtareas.titulo }}
                                </td>
                                <td contenteditable="true" (blur)="saveToDatabase($event, 'descripcion', subtareas.id)">
                                    {{ subtareas.descripcion }}
                                </td>
                                <td (change)="saveToDatabase($event, 'completa', subtareas.id)">
                                    <div *ngIf="subtareas.completa == 1" class="onoffswitch">
                                        <input type="radio" name="onoffswitch-{{subtareas.id}}" class="onoffswitch-checkbox" id="myonoffswitch-{{subtareas.id}}" value="0">
                                        <input type="radio" name="onoffswitch-{{subtareas.id}}" class="onoffswitch-checkbox" id="myonoffswitch-{{subtareas.id}}" value="1" checked>
                                        <label class="onoffswitch-label" for="myonoffswitch-{{subtareas.id}}">
                                            <span class="onoffswitch-inner"></span>
                                            <span class="onoffswitch-switch"></span>
                                        </label>
                                    </div>
                                    <div *ngIf="subtareas.completa == 0" class="onoffswitch">
                                        <input type="radio" name="onoffswitch-{{subtareas.id}}" class="onoffswitch-checkbox" id="myonoffswitch-{{subtareas.id}}" value="1">
                                        <label class="onoffswitch-label" for="myonoffswitch-{{subtareas.id}}">
                                            <span class="onoffswitch-inner"></span>
                                            <span class="onoffswitch-switch"></span>
                                        </label>
                                    </div>
                                </td>
                                <td>
                                    <a data-toggle="modal" data-target="#eliminar-subtarea" class="btn btn-danger sbold btn-sm" (click)="onDeleteSubtarea(subtareas)"><i class="fa fa-trash" aria-hidden="true"></i></a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

            </form>

        </div>

    </div>
</div>

<!-- MODAL ELIMINAR SUBTAREA -->
<div class="modal fade" id="eliminar-subtarea" tabindex="-1" role="basic" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">

            <div class="modal-header">

                <h4 class="modal-title">Eliminar Subtarea</h4>

            </div>

            <div class="modal-body">
                <h2 *ngIf="deleteSubtareas">Desea eliminar la subtarea <strong>{{ deleteSubtareas.titulo }}</strong>?</h2>
            </div>

            <div class="modal-footer">
                <form>
                    <button type="button" class="btn dark btn-outline" data-dismiss="modal">Cerrar</button>
                    <button class="btn btn-danger sbold" (click)="deleteSubtarea()">
                        Eliminar subtarea
                    </button>
                </form>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>
